{"version":3,"sources":["jquery.doogieboard.min.js"],"names":["$","formatAMPM","date","hours","getHours","minutes","getMinutes","ampm","defaults","days","host","sparkline","disableInteraction","width","height","lineWidth","lineColor","fillColor","chartRangeMin","chartRangeMax","spotColor","minSpotColor","maxSpotColor","fn","doogieboard","options","isTimeago","jQuery","timeago","extend","isNaN","eventPromise","get","__populate","__sort","servicePromise","statusPromise","this","each","index","elem","$elem","addClass","$table","$thead","$tr","$tbody","append","i","l","text","when","done","events","services","statuses","level0Status","hash","length","level","console","log","Date","service","_id","name","j","k","$td","data","toISOString","getMonth","getDate","setDate","_lastStatus","find","html","event","createdAt","_service","_status","eventCount","message","trigger","legend","$legend","status","description","wrap","prepend","serviceId","hourly","$sparkline","$activeDay","$activeInfo","on","removeClass","remove","undefined","parent","getFullYear","after"],"mappings":"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","file":"jquery.doogieboard.min.js","sourcesContent":["!function(e){\"use strict\";function a(e){var a=e.getHours(),t=e.getMinutes(),s=a>=12?\"pm\":\"am\";return a%=12,a=a?a:12,t=10>t?\"0\"+t:t,a+\":\"+t+s}var t={days:5,host:\"http://doogie.amp.aol.com/api/\",sparkline:{disableInteraction:!0,width:62,height:20,lineWidth:1,lineColor:\"#6b6b6b\",fillColor:\"#f5f5f5\",chartRangeMin:0,chartRangeMax:100,spotColor:!1,minSpotColor:!1,maxSpotColor:!1}};e.fn.doogieboard=function(s){var o=!!jQuery.timeago;s=s||{},s=e.extend({},t,s),(isNaN(s.days)||s.days<1)&&(s.days=t.days);var n=e.get(s.host+\"events\",{__populate:\"_status _service\",__sort:\"-createdAt\"}),d=e.get(s.host+\"services\",{__populate:\"_lastStatus\",__sort:\"name\"}),r=e.get(s.host+\"statuses\",{__sort:\"level\"});this.each(function(t,l){var i=s.days,v=e(l).addClass(\"doogieboard\"),g=e('<table class=\"table\"></table>'),p=e(\"<thead></thead>\"),c=e(\"<tr></tr>\"),u=e(\"<tbody></tbody>\");c.append(\"<th>Service</th>\");for(var h=0,m=i;m>h;h+=1){var f;f=0===h?\"Today\":1===h?\"Yesterday\":h+\" days ago\",c.append(\"<th>\"+f+\"</th>\")}p.append(c),e.when(n,d,r).done(function(t,n,d){var r,l={};d=d[0];for(var c=0,h=d.length;h>c;c+=1)if(0===d[c].level){r=d[c],console.log(\"Setting level0Status:\",r);break}r||console.log(\"Doogieboard Error: Please configure a level 0 status.\"),n=n[0];for(var c=0,h=n.length;h>c;c+=1){var m=new Date,f=n[c];l[f._id]={};var b=e(\"<tr></tr>\");b.append('<td class=\"doogieboard-service-name\" data-service-id=\"'+f._id+'\"><b>'+f.name+\"</b></td>\");for(var _=0,y=i;y>_;_+=1){var C=e('<td class=\"doogieboard-day daysago-'+_+'\"><span class=\"doogieboard-badge\"><b class=\"event-count\"></b><i class=\"event-status\">'+r.name+\"</i></span></td>\");C.data(\"eventCount\",0),C.data(\"date\",m.toISOString()),l[f._id][m.getMonth()+\"-\"+m.getDate()]=C,b.append(C),m.setDate(m.getDate()-1),0===_&&f._lastStatus&&(C.addClass(\"level-\"+f._lastStatus.level),C.find(\".event-status\").html(f._lastStatus.name))}u.append(b)}t=t[0];for(var S,c=0,h=t.length;h>c;c+=1){S=t[c];var D=new Date(S.createdAt),C=l[S._service._id][D.getMonth()+\"-\"+D.getDate()];if(C){C.data(\"hasEvents\")||(C.data(\"hasEvents\",!0),C.addClass(\"doogieboard-events\"),C.addClass(\"level-\"+S._status.level),C.find(\".event-status\").html(S._status.name));var k=C.data(\"eventCount\")+1;C.data(\"eventCount\",k),C.find(\".event-count\").html(k),C.append('<div class=\"event level-'+S._status.level+'\"><h5><b class=\"status\">'+S._status.name+\"</b> <small>at \"+a(D)+', <time class=\"timeago\" datetime=\"'+D.toISOString()+'\">'+D.getMonth()+\"/\"+D.getDate()+\" \"+D.getHours()+\":\"+D.getMinutes()+'</time></small></h5><p class=\"message\">'+S.message+\"</p></div>\")}}if(g.append(p),g.append(u),v.append(g),v.trigger(\"doogieboard-ready\"),s.legend){d=d[0];for(var M=e('<ul class=\"status-list\"></ul>'),c=0,h=d.length;h>c;c+=1){var w=d[c];M.append('<li class=\"status-item level-'+w.level+'\"><b>'+w.name+\"</b> <i>\"+w.description+\"</li>\")}M.wrap('<div class=\"legend\"></div>'),M.prepend(\"<h2>Status Legend</h2>\"),v.append(M)}o&&v.find(\".timeago\").timeago(),s.sparkline&&g.find(\".doogieboard-service-name\").each(function(){var a=e(this),t=a.data(\"serviceId\");e.get(s.host+\"services/\"+t+\"/sparkline\",function(t){if(t.hourly&&t.hourly.length){var o=e('<span class=\"doogieboard-sparkline\"></span>');a.append(o),o.sparkline(t.hourly,s.sparkline)}})});var I,x;v.on(\"click\",\"td.doogieboard-events\",function(){var a=e(this);if(I&&(I.removeClass(\"events-open active\"),x.remove(),I[0]===a[0]))return void(I=x=void 0);a.addClass(\"events-open active\"),I=a;var t=a.parent(),s=new Date(a.data(\"date\"));s=s.getMonth()+1+\"/\"+s.getDate()+\"/\"+s.getFullYear(),x=e('<tr class=\"doogieboard-info active\"><td><span class=\"date\">'+s+'</span></td><td colspan=\"'+i+'\">'+a.html()+\"</td></tr>\"),t.after(x)})})})}}(jQuery);\n//# sourceMappingURL=jquery.doogieboard.min.js.map"],"sourceRoot":"/source/"}