{"version":3,"sources":["jquery.doogieboard.min.js"],"names":["$","formatAMPM","date","hours","getHours","minutes","getMinutes","ampm","defaults","days","host","sparkline","disableInteraction","width","height","lineWidth","lineColor","fillColor","chartRangeMin","chartRangeMax","spotColor","minSpotColor","maxSpotColor","fn","doogieboard","options","isTimeago","jQuery","timeago","extend","isNaN","eventPromise","get","__populate","__sort","servicePromise","statusPromise","this","each","index","elem","$elem","addClass","$table","$thead","$tr","$tbody","append","i","l","text","when","done","events","services","statuses","hash","length","Date","service","_id","name","j","k","$td","console","log","data","toISOString","getMonth","getDate","setDate","_lastStatus","level","event","createdAt","_service","_status","find","html","eventCount","message","legend","$legend","status","description","wrap","prepend","serviceId","hourly","$sparkline","$activeDay","$activeInfo","on","removeClass","remove","undefined","parent","getFullYear","after"],"mappings":"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","file":"jquery.doogieboard.min.js","sourcesContent":["!function(e){\"use strict\";function a(e){var a=e.getHours(),t=e.getMinutes(),s=a>=12?\"pm\":\"am\";return a%=12,a=a?a:12,t=10>t?\"0\"+t:t,a+\":\"+t+s}var t={days:5,host:\"http://doogie-env.elasticbeanstalk.com/api/\",sparkline:{disableInteraction:!0,width:62,height:20,lineWidth:1,lineColor:\"#6b6b6b\",fillColor:\"#f5f5f5\",chartRangeMin:0,chartRangeMax:100,spotColor:!1,minSpotColor:!1,maxSpotColor:!1}};e.fn.doogieboard=function(s){var n=!!jQuery.timeago;s=s||{},s=e.extend({},t,s),(isNaN(s.days)||s.days<1)&&(s.days=t.days);var d=e.get(s.host+\"events\",{__populate:\"_status _service\",__sort:\"-createdAt\"}),o=e.get(s.host+\"services\",{__populate:\"_lastStatus\",__sort:\"name\"}),i=e.get(s.host+\"statuses\",{__sort:\"level\"});this.each(function(t,r){var l=s.days,v=e(r).addClass(\"doogieboard\"),p=e('<table class=\"table\"></table>'),c=e(\"<thead></thead>\"),g=e(\"<tr></tr>\"),u=e(\"<tbody></tbody>\");g.append(\"<th>Service</th>\");for(var h=0,b=l;b>h;h+=1){var m;m=0===h?\"Today\":1===h?\"Yesterday\":h+\" days ago\",g.append(\"<th>\"+m+\"</th>\")}c.append(g),e.when(d,o,i).done(function(t,d,o){var i={};d=d[0];for(var r=0,g=d.length;g>r;r+=1){var h=new Date,b=d[r];i[b._id]={};var m=e(\"<tr></tr>\");m.append('<td class=\"doogieboard-service-name\" data-service-id=\"'+b._id+'\"><b>'+b.name+\"</b></td>\");for(var f=0,_=l;_>f;f+=1){var y=e('<td class=\"doogieboard-day daysago-'+f+'\"><span class=\"doogieboard-badge\"><b class=\"event-count\"></b><i class=\"event-status\">Online</i></span></td>');console.log(y),y.data(\"eventCount\",0),y.data(\"date\",h.toISOString()),i[b._id][h.getMonth()+\"-\"+h.getDate()]=y,m.append(y),h.setDate(h.getDate()-1),0===f&&b._lastStatus&&y.addClass(\"level-\"+b._lastStatus.level)}u.append(m)}t=t[0];for(var C,r=0,g=t.length;g>r;r+=1){C=t[r];var S=new Date(C.createdAt),y=i[C._service._id][S.getMonth()+\"-\"+S.getDate()];if(y){y.data(\"hasEvents\")||(y.data(\"hasEvents\",!0),y.addClass(\"doogieboard-events\"),y.addClass(\"level-\"+C._status.level),y.find(\".event-status\").html(C._status.name));var D=y.data(\"eventCount\")+1;y.data(\"eventCount\",D),y.find(\".event-count\").html(D),y.append('<div class=\"event level-'+C._status.level+'\"><h5><b class=\"status\">'+C._status.name+\"</b> <small>at \"+a(S)+', <time class=\"timeago\" datetime=\"'+S.toISOString()+'\">'+S.getMonth()+\"/\"+S.getDate()+\" \"+S.getHours()+\":\"+S.getMinutes()+'</time></small></h5><p class=\"message\">'+C.message+\"</p></div>\")}}if(p.append(c),p.append(u),v.append(p),s.legend){o=o[0];for(var k=e('<ul class=\"status-list\"></ul>'),r=0,g=o.length;g>r;r+=1){var M=o[r];k.append('<li class=\"status-item level-'+M.level+'\"><b>'+M.name+\"</b> <i>\"+M.description+\"</li>\")}k.wrap('<div class=\"legend\"></div>'),k.prepend(\"<h2>Status Legend</h2>\"),v.append(k)}n&&v.find(\".timeago\").timeago(),s.sparkline&&p.find(\".doogieboard-service-name\").each(function(){var a=e(this),t=a.data(\"serviceId\");e.get(s.host+\"services/\"+t+\"/sparkline\",function(t){if(t.hourly&&t.hourly.length){var n=e('<span class=\"doogieboard-sparkline\"></span>');a.append(n),n.sparkline(t.hourly,s.sparkline)}})});var w,I;v.on(\"click\",\"td.doogieboard-events\",function(){var a=e(this);if(w&&(w.removeClass(\"events-open active\"),I.remove(),w[0]===a[0]))return void(w=I=void 0);a.addClass(\"events-open active\"),w=a;var t=a.parent(),s=new Date(a.data(\"date\"));s=s.getMonth()+1+\"/\"+s.getDate()+\"/\"+s.getFullYear(),I=e('<tr class=\"doogieboard-info active\"><td><span class=\"date\">'+s+'</span></td><td colspan=\"'+l+'\">'+a.html()+\"</td></tr>\"),t.after(I)})})})}}(jQuery);\n//# sourceMappingURL=jquery.doogieboard.min.js.map"],"sourceRoot":"/source/"}